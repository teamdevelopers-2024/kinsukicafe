import{r as s,j as e,L as E}from"./index-DAiR3oa6.js";import I from"./Navbar-CBZCZxDR.js";import{a as f}from"./api-6F4pbJpc.js";import{s as C,a as T,e as B,S as c}from"./sweetalert2.esm.all-B4pWJWnF.js";import{s as k}from"./searchIcon-CH9qlvue.js";const D=({setAddCategoryModal:n})=>{const[i,p]=s.useState(""),[d,g]=s.useState(!1),[u,l]=s.useState(""),r=()=>i.trim()?(l(""),!0):(l("Category name is required."),!1),h=async()=>{if(!r())return;g(!0);const m={categoryName:i};console.log(i);try{const x=await f.addCategory(m);if(x.error){l(x.message);return}C("Success!","Category added successfully!","success"),n(!1)}catch(x){console.error(x),C("Error!","Failed to add category.","error")}finally{g(!1)}};return e.jsxs(e.Fragment,{children:[d&&e.jsx(E,{}),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-30",children:e.jsxs("div",{className:"bg-gray-800 text-white rounded-lg shadow-lg p-6 w-full max-w-lg mx-auto",children:[e.jsx("h2",{className:"text-xl mb-4",children:"Add Category"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block mb-2",children:"Category Name"}),e.jsx("input",{type:"text",className:`p-2 ${u?"border-red-600 border-2":""} bg-gray-700 rounded w-full`,value:i.toUpperCase(),onChange:m=>p(m.target.value.toUpperCase()),placeholder:"Enter category name"}),u&&e.jsx("p",{className:"text-red-500 mt-2",children:u})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:()=>n(!1),className:"bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded mr-2",children:"Cancel"}),e.jsx("button",{onClick:h,className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded",children:"Save"})]})]})})]})},L=({category:n,onClose:i})=>{const[p,d]=s.useState([]),[g,u]=s.useState(!1);return s.useEffect(()=>{(async()=>{if(n&&n.name){u(!0);try{const r=await f.getItems();if(console.log("API Response:",r.data),Array.isArray(r.data)){const h=r.data.filter(m=>m.category===n.name);d(h)}else console.error("Expected an array, but got:",r),d([])}catch(r){console.error("Error fetching items:",r),d([])}finally{u(!1)}}})()},[n]),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-[#23346c] p-4 rounded-md w-1/3",children:[e.jsxs("h2",{className:"text-lg items-center text-[#ffeda5] font-bold mb-4",children:[n.name," Category Items"]}),e.jsx("ul",{children:g?e.jsx("div",{children:"Loading..."}):p.length>0?p.map((l,r)=>e.jsxs("li",{className:"py-2 text-[#ffeda5]",children:[r+1,". ",l.name," - â‚¹",l.price]},r)):e.jsx("li",{children:"No items found."})}),e.jsx("button",{className:"mt-4 bg-[#ffeda5] text-[#23346c] px-4 py-2 rounded-md",onClick:i,children:"Close"})]})})};function P(){const[n,i]=s.useState([]),[p,d]=s.useState(!1),[g,u]=s.useState(""),[l,r]=s.useState(null),[h,m]=s.useState(!1),[x,y]=s.useState(!1),w=t=>{r(t),m(!0)},N=()=>{m(!1),r(null)};s.useEffect(()=>{(async()=>{try{const a=await f.getCatogory();console.log(a),a.error||i(a.data)}catch(a){console.log(a)}})()},[p,x]);const b=n.filter(t=>t.name.toLowerCase().includes(g.toLowerCase())),v=async t=>{const{value:a}=await c.fire({title:"Confirm Deletion",input:"password",inputLabel:"Please enter your password",inputPlaceholder:"Password",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Cancel",inputValidator:o=>{if(!o)return"You need to enter a password!";if(o!=="1234")return"Incorrect Password"}});if(a==="1234")try{(await f.deleteCategory(t)).error?c.fire("Error","There was an error deleting the Category.","error"):(y(!x),c.fire("Deleted!","Your Category has been deleted.","success"))}catch(o){console.error("Error deleting Category:",o),c.fire("Error","There was an error deleting the Category.","error")}},S=async t=>{const{value:a}=await c.fire({title:"Confirm Update",input:"password",inputLabel:"Please enter your password",inputPlaceholder:"Password",showCancelButton:!0,confirmButtonText:"Continue",cancelButtonText:"Cancel",inputValidator:o=>{if(!o)return"You need to enter a password!";if(o!=="1234")return"Incorrect Password!"}});if(a==="1234"){const{value:o}=await c.fire({title:"Update Category",html:`
        <div style="margin-bottom: 10px;">
          <label for="name" style="display: block; margin-bottom: 2px; font-weight: bold;">Category Name:</label>
          <input id="name" type="text" class="swal2-input" style="width: 250px; height: 36px; padding: 8px; box-sizing: border-box;" value="${t.name}">
        </div>
      `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Update",cancelButtonText:"Cancel",preConfirm:()=>({name:document.getElementById("name").value})});if(o)try{(await f.updateCategory(t._id,o)).error?c.fire("Error","There was an error updating the Category.","error"):(y(!x),c.fire("Updated!","Your Category has been updated.","success"))}catch(j){c.fire("Error","There was an error updating the Category.","error"),console.error("Error updating expense:",j)}}};return e.jsxs(e.Fragment,{children:[p&&e.jsx(D,{setAddCategoryModal:d}),e.jsxs("div",{className:"min-h-screen bg-[#23346c] p-10 text-gray-100 relative",children:[e.jsxs("div",{className:"flex justify-end gap-4 items-center mb-8",children:[e.jsx("button",{onClick:()=>d(!0),className:"bg-blue-500 px-4 py-2 rounded-md text-white hover:bg-blue-700",children:"Add Category"}),e.jsx("div",{className:"bg-[#00BDD6] bg-opacity-10 px-2 border border-[#00BDD6] rounded-lg",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx("img",{src:k,alt:""}),e.jsx("input",{type:"text",placeholder:"Search category...",className:"w-64 h-10 px-3 rounded bg-transparent text-white outline-none",value:g,onChange:t=>u(t.target.value)})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto  w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-800",children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2",children:"Category Name"}),e.jsx("th",{className:"px-4 py-2",children:"Total Items"}),e.jsx("th",{className:"px-4 py-2",children:"View"}),e.jsx("th",{className:"px-4 py-2",children:"Action"})]})}),e.jsxs("tbody",{className:"bg-gray-700",children:[b.map((t,a)=>e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("td",{className:"px-4 py-2",children:a+1}),e.jsx("td",{className:"px-4 py-2",children:t.name}),e.jsx("td",{className:"px-4 py-2",children:t.totalItems}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("button",{className:"bg-green-500 px-3 py-1 rounded-md text-white hover:bg-green-700",onClick:()=>w(t),children:"View"})}),e.jsxs("td",{className:"px-4 py-2 flex gap-3",children:[e.jsx(T,{onClick:()=>v(t._id),className:"text-red-600 cursor-pointer"}),e.jsx(B,{onClick:()=>S(t),className:"text-blue-700 cursor-pointer"})]})]},a)),b.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-4",children:"No categories found."})})]})]})})]}),h&&e.jsx(L,{category:l,onClose:N})]})}function Y(){return e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx(P,{})]})}export{Y as default};
